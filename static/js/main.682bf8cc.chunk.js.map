{"version":3,"sources":["component/skill-card.tsx","component/schedule-caroussel.tsx","component/level-list.tsx","page/level-page.tsx","component/exercice-modal.tsx","page/skill-page.tsx","service/service-api.ts","service/database-service.ts","index.tsx"],"names":["SkillCard","React","render","this","props","id","to","className","header","alt","src","image","title","name","shape","responsiveOptions","breakpoint","numVisible","numScroll","SubjectCaroussel","circular","value","skills","itemTemplate","skill","subject_id","description","exercices","premium","LevelList","subjects","map","s","key","LevelPage","constructor","super","state","componentDidMount","database","getSubjects","then","setState","ExericeModal","prop","started","step","done","time","success","getContent","exercice","answer","getQuestion","getNbStep","Math","max","questions","length","result","i","getResponses","finish","onFinish","Date","now","date","exercice_id","start","nextStep","close","getFooter","label","icon","onClick","autoFocus","index","visible","style","width","footer","onHide","SkillPage","window","location","href","split","pop","getSkill","getVideoId","link","addResult","videoId","video","layout","dangerouslySetInnerHTML","__html","exo","ServiceAPI","getSubject","Promise","resolve","reject","fetch","response","json","regexp","RegExp","Map","has","chapitre","ID","set","post_title","push","skill_id","enonce","correction","tip","nom","content","rendered","difficulty","difficulte","thumbnail","guid","order","ordering","get","Array","from","values","DatabaseService","api","db","Dexie","DB_NAME","version","stores","results","isCreated","exists","table","add","toArray","getExercice","initialize","forEach","bulkPut","App","databaseLoaded","path","rootElement","document","getElementById"],"mappings":"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","file":"static/js/main.682bf8cc.chunk.js","sourcesContent":["import * as React from \"react\";\nimport { Card } from 'primereact/card';\nimport { Skeleton } from 'primereact/skeleton';\nimport { Skill } from \"../model/skill\";\nimport { Link } from \"react-router-dom\";\n\n\nclass SkillCard extends React.Component<Skill, any> {\n\n    public render() {\n        if (!this.props.id) {\n            return (\n                <Card className=\"p-mr-2 p-mb-2\">\n                    <p><Skeleton shape=\"rectangle\" /></p>\n                    <p><Skeleton shape=\"rectangle\" /></p>\n                </Card>\n            )\n        }\n        return (\n            <Link to={`/skill/${this.props.id}`}>\n                <Card className=\"p-mr-2 p-mb-2\"\n                    header={<img alt=\"Card\" src={this.props.image} />}\n                    title={this.props.name}>\n                </Card>\n            </Link>\n\n        );\n    }\n}\n\nexport default SkillCard;\n","import * as React from \"react\";\nimport { Skill } from \"../model/skill\";\nimport { Subject } from \"../model/subject\";\nimport { Carousel } from \"primereact/carousel\";\nimport SkillCard from \"./skill-card\";\n\n\nconst responsiveOptions = [\n    {\n        breakpoint: '1024px',\n        numVisible: 3,\n        numScroll: 3\n    },\n    {\n        breakpoint: '768px',\n        numVisible: 2,\n        numScroll: 2\n    },\n    {\n        breakpoint: '560px',\n        numVisible: 1,\n        numScroll: 1\n    }\n];\nclass SubjectCaroussel extends React.Component<Subject, any> {\n\n    public render() {\n        return (\n            <div className=\"card\">\n                <h5>{this.props.name}</h5>\n                <Carousel\n                    responsiveOptions={responsiveOptions}\n                    numVisible={3}\n                    numScroll={1}\n                    circular={true}\n                    value={this.props.skills}\n                    itemTemplate={(skill: Skill) => <SkillCard id={skill.id} subject_id={skill.subject_id} name={skill.name} description={skill.description} exercices={skill.exercices} image={skill.image} premium={skill.premium}></SkillCard>}\n                ></Carousel>\n            </div>\n        );\n    }\n}\n\nexport default SubjectCaroussel;\n","import * as React from \"react\";\nimport { Level } from \"../model/level\";\nimport SubjectCaroussel from \"./schedule-caroussel\";\n\n\nclass LevelList extends React.Component<Level, any> {\n\n    public render() {\n        return (\n            <div className=\"p-mr-2 p-p-3 p-mb-2\">\n                <h1>{this.props.name}</h1>\n                <h2>{this.props.description}</h2>\n                <div className=\"\">\n                    {\n                        this.props.subjects.map(s => <SubjectCaroussel\n                            key={s.id}\n                            id={s.id}\n                            name={s.name}\n                            description={s.description}\n                            skills={s.skills}>\n                        </SubjectCaroussel>)\n                    }\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default LevelList;\n","import * as React from \"react\";\nimport LevelList from \"../component/level-list\";\nimport { Subject } from \"../model/subject\";\nimport DatabaseService from \"../service/database-service\";\n\nclass LevelPageProp {\n    constructor(public database: DatabaseService) { }\n}\nclass LevelPageModel {\n    constructor(public subjects: Subject[] = []) { }\n}\nclass LevelPage extends React.Component<LevelPageProp, LevelPageModel> {\n\n    constructor(props: any) {\n        super(props);\n        this.state = {\n            subjects: []\n        };\n    }\n\n    public componentDidMount() {\n        this.props.database.getSubjects().then((subjects: Subject[]) => {\n            this.setState({\n                subjects\n            })\n        });\n    }\n\n    public render() {\n        return (\n            <div className=\"card\">\n                <h2>POC</h2>\n                <LevelList id=\"0\" description=\"\"\n                    name=\"PremiÃ¨re\" subjects={this.state.subjects}></LevelList>\n            </div>\n        );\n    }\n}\n\nexport default LevelPage;\n","import * as React from \"react\";\nimport { Exercice } from \"../model/exercice\";\nimport { Dialog } from 'primereact/dialog';\nimport { Button } from 'primereact/button';\nimport 'katex/dist/katex.min.css'\nimport Latex from 'react-latex-next'\n\nclass ExericeModalProps {\n    constructor(public exercice: Exercice, public onFinish: Function) { }\n}\nclass ExericeModal extends React.Component<ExericeModalProps, any> {\n\n    constructor(prop: ExericeModalProps) {\n        super(prop);\n        this.state = {\n            started: false,\n            step: 1,\n            done: false,\n            time: 0,\n            success: false\n        }\n    }\n\n    public getContent() {\n        if (this.state.done) {\n            return this.props.exercice.answer;\n        }\n        return this.getQuestion();\n    }\n\n    public getNbStep() {\n        return Math.max(this.props.exercice.questions.length - 1, 1);\n    }\n\n    public getQuestion() {\n        let result = this.props.exercice.questions[0];\n        for (let i = 1; i <= this.state.step; i += 1) {\n            if (this.props.exercice.questions[i]) {\n                result += '<li>' + this.props.exercice.questions[i]\n            }\n        }\n        return result;\n    }\n\n    public getResponses() {\n        return [\"Reponse A\", \"Reponse B\", \"Reponse C\", \"Reponse D\"]\n    }\n\n    public finish() {\n        this.props.onFinish({\n            id: Date.now(),\n            success: true,\n            date: Date.now(),\n            exercice_id: this.props.exercice.id,\n            time: Date.now() - this.state.time\n        });\n        this.setState({\n            done: true,\n            success: true\n        });\n    }\n\n    public start() {\n        this.setState({\n            started: true,\n            time: Date.now()\n        })\n    }\n\n    public nextStep() {\n        if (this.state.step === this.getNbStep()) {\n            this.finish();\n        } else {\n            this.setState({\n                step: this.state.step + 1\n            });\n        }\n    }\n\n    public close() {\n        this.setState({\n            done: false,\n            step: 1,\n            started: false\n        })\n    }\n\n    public getFooter() {\n        if (!this.state.done) {\n            return <div>\n                {\n                    this.getResponses().map((value, index) =>\n                        <Button key={index} label={value} onClick={() => this.nextStep()} className=\"p-button-text\" />\n                    )\n                }\n            </div>\n        }\n        return <div>\n            <Button label=\"C'est compris\" icon=\"pi pi-check\" onClick={() => this.close()} autoFocus />\n        </div>\n    }\n\n    public render() {\n        return (\n            <div className=\"card\">\n                <Button label={this.props.exercice.name} icon=\"pi pi-external-link\" onClick={() => this.start()} />\n                <Dialog header={this.props.exercice.name} visible={this.state.started} style={{ width: '50vw' }} footer={this.getFooter()} onHide={() => this.close()}>\n                    <Latex>{this.getContent()}</Latex>\n                </Dialog>\n            </div >\n\n        );\n    }\n}\n\nexport default ExericeModal;\n","import * as React from \"react\";\nimport { Skill } from \"../model/skill\";\nimport ExericeModal from \"../component/exercice-modal\";\nimport YouTube from 'react-youtube';\nimport DatabaseService from \"../service/database-service\";\nimport { Result } from \"../model/result\";\nimport { Divider } from 'primereact/divider';\n\nclass SkillPageProp {\n    constructor(public database: DatabaseService) { }\n}\nclass SkillPageModel {\n    constructor(public skill: Skill) { }\n}\nclass SkillPage extends React.Component<SkillPageProp, SkillPageModel> {\n\n    constructor(prop: any) {\n        super(prop);\n        this.state = {\n            skill: {\n                id: \"\",\n                name: \"\",\n                description: \"\",\n                subject_id: \"\",\n                exercices: []\n            }\n        }\n    }\n\n\n    public componentDidMount() {\n        let id = +(window.location.href.split('/').pop() || '8329');\n        this.props.database.getSkill(id).then((skill: Skill) => {\n            this.setState({\n                skill\n            })\n        });\n    }\n\n    public getVideoId(link?: string) {\n        if (link) {\n            return link.split('/').pop();\n        }\n        return '';\n    }\n\n    public addResult(result: Result) {\n        this.props.database.addResult(result);\n    }\n\n    public render() {\n        return (\n            <div className=\"card\">\n                <h2>{this.state.skill?.name}</h2>\n                <div className=\"p-d-flex\">\n                    <YouTube\n                        videoId={this.getVideoId(this.state.skill.video)}\n                    />\n\n                    <Divider layout=\"vertical\" />\n                    <div\n                        dangerouslySetInnerHTML={{\n                            __html: this.state.skill.description\n                        }}></div>\n                </div>\n                <h2>Exercice</h2>\n                {\n                    this.state.skill.exercices.map((exo, value) =>\n                        <ExericeModal key={value} exercice={exo} onFinish={(result: Result) => (this.addResult(result))} />\n                    )\n                }\n            </div>\n        );\n    }\n}\n\nexport default SkillPage;\n","import { Skill } from \"../model/skill\";\nimport { Exercice } from \"../model/exercice\";\nimport { Subject } from \"../model/subject\";\n\nconst URL = 'https://cours-galilee.com/wp-json/wp/v2/comptence?per_page=100&orderby=title&order=asc';\n\nclass ServiceAPI {\n\n    public getSubject(): Promise<Subject[]> {\n        return new Promise((resolve, reject) => {\n            fetch(URL)\n                .then(response => response.json())\n                .then(json => {\n                    var regexp = new RegExp('<li>');\n                    var subjects: Map<number, Subject> = new Map();\n                    json.map((value: any) => {\n                        if (!subjects.has(value.chapitre[0].ID)) {\n                            subjects.set(value.chapitre[0].ID, {\n                                id: value.chapitre[0].ID,\n                                name: value.chapitre[0].post_title,\n                                description: \"\",\n                                skills: []\n                            });\n                        }\n                        let exercices: Exercice[] = [];\n                        (value.exercices || []).map((exo: any) =>\n                            exercices.push({\n                                id: exo.id,\n                                skill_id: value.id,\n                                name: exo.post_title,\n                                description: \"\",\n                                enonce: exo.enonce,\n                                questions: exo.enonce.split(regexp) || 1,\n                                answer: exo.correction,\n                                tip: \"demerde-toi\"\n                            })\n                        );\n                        let skill: Skill = {\n                            id: value.id,\n                            subject_id: value.chapitre[0].id,\n                            name: value.nom,\n                            description: value.content.rendered,\n                            premium: false,\n                            difficulty: +value.difficulte,\n                            video: value.video,\n                            image: value.thumbnail.guid,\n                            order: +value.ordering,\n                            exercices: exercices,\n                        };\n                        subjects.get(value.chapitre[0].id)?.skills.push(skill);\n                        return skill;\n                    });\n                    resolve(Array.from(subjects.values()));\n                });\n        });\n    }\n}\n\nexport default ServiceAPI;","import Dexie from 'dexie';\nimport ServiceAPI from './service-api';\nimport { Result } from '../model/result';\nimport { Subject } from '../model/subject';\nimport { Skill } from '../model/skill';\nimport { Exercice } from '../model/exercice';\n\n\n\nclass DatabaseService {\n\n    private static DB_NAME: string = 'galileo';\n    private api: ServiceAPI;\n    private db: Dexie;\n\n    constructor() {\n        this.api = new ServiceAPI();\n        this.db = new Dexie(DatabaseService.DB_NAME);\n        this.db.version(1).stores({\n            subjects: 'id',\n            skills: 'id',\n            exercices: 'id',\n            questions: 'id',\n            results: 'id',\n        });\n    }\n\n    public isCreated(): Promise<Boolean> {\n        return Dexie.exists(DatabaseService.DB_NAME);\n    }\n\n    public addResult(result: Result): Promise<any> {\n        return this.db.table(\"results\").add(result);\n    }\n\n    public getSubjects(): Promise<Subject[]> {\n        return this.db.table(\"subjects\").toArray();\n    }\n\n    public getSkill(id: number): Promise<Skill> {\n        return this.db.table(\"skills\").get(id);\n    }\n\n    public getExercice(id: number): Promise<Exercice> {\n        return this.db.table(\"exercices\").get(id);\n    }\n\n\n    public initialize(): Promise<Boolean> {\n        return new Promise((resolve) => {\n            this.api.getSubject().then((subjects) => {\n                subjects.forEach(s => {\n                    this.db.table(\"skills\").bulkPut(s.skills)\n                    s.skills.forEach(skill => {\n                        this.db.table(\"exercices\").bulkPut(skill.exercices);\n                    })\n                })\n                this.db.table(\"subjects\").bulkPut(subjects);\n                resolve(true);\n            });\n        });\n    }\n\n}\n\nexport default DatabaseService;","import * as React from \"react\";\nimport { render } from \"react-dom\";\nimport {\n    HashRouter as Router,\n    Switch,\n    Route,\n} from \"react-router-dom\";\nimport 'primereact/resources/themes/saga-blue/theme.css';\nimport 'primereact/resources/primereact.min.css';\nimport 'primeicons/primeicons.css';\nimport 'primeflex/primeflex.css';\nimport \"./styles.css\";\nimport { ProgressSpinner } from 'primereact/progressspinner';\nimport LevelPage from \"./page/level-page\";\nimport SkillPage from \"./page/skill-page\";\nimport DatabaseService from \"./service/database-service\";\n\nclass AppState {\n    constructor(public databaseLoaded: boolean = false) { }\n}\nclass App extends React.Component<any, AppState> {\n\n    private database: DatabaseService;\n\n    constructor(prop: any) {\n        super(prop);\n        this.state = {\n            databaseLoaded: false\n        };\n        this.database = new DatabaseService();\n    }\n\n\n    public componentDidMount() {\n        /*this.database.isCreated().then(value => {\n            if (!value) {\n                this.database.initialize().then(() => this.setState({ databaseLoaded: true }));\n            } else {\n                this.setState({ databaseLoaded: true });\n            }\n        });*/\n        this.database.initialize().then(() => this.setState({ databaseLoaded: true }));\n\n    }\n\n    public render() {\n        if (!this.state.databaseLoaded) {\n            return (\n                <div className=\"card\"><ProgressSpinner /></div>\n            );\n        }\n        return (\n            <Router>\n                <div className=\"p-component\">\n                    <div className=\"p-mr-2\">\n                        <Switch>\n                            <Route path=\"/skill/:id\">\n                                <SkillPage database={this.database} />\n                            </Route>\n                            <Route path=\"/\">\n                                <LevelPage database={this.database} />\n                            </Route>\n                        </Switch>\n                    </div>\n                </div>\n            </Router>\n        );\n    }\n}\n\nconst rootElement = document.getElementById(\"root\");\nrender(<App />, rootElement);\n"],"sourceRoot":""}