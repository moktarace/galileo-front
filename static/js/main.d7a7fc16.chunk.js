(this["webpackJsonpgalileo-front"]=this["webpackJsonpgalileo-front"]||[]).push([[0],{38:function(e,t,s){e.exports=s(83)},47:function(e,t,s){},83:function(e,t,s){"use strict";s.r(t);var i=s(0),a=s(9),r=s(11),n=s(2),l=(s(43),s(44),s(45),s(46),s(47),s(29)),c=s(30),o=s(16),d=s(17);class p extends i.Component{render(){return this.props.id?i.createElement(r.b,{to:"/skill/".concat(this.props.id)},i.createElement(o.Card,{className:"p-mr-2 p-mb-2",header:i.createElement("img",{alt:"Card",src:this.props.image}),title:this.props.name})):i.createElement(o.Card,{className:"p-mr-2 p-mb-2"},i.createElement("p",null,i.createElement(d.Skeleton,{shape:"rectangle"})),i.createElement("p",null,i.createElement(d.Skeleton,{shape:"rectangle"})))}}var m=p;const u=[{breakpoint:"1024px",numVisible:3,numScroll:3},{breakpoint:"768px",numVisible:2,numScroll:2},{breakpoint:"560px",numVisible:1,numScroll:1}];class h extends i.Component{render(){return i.createElement("div",{className:"card"},i.createElement("h5",null,this.props.name),i.createElement(c.Carousel,{responsiveOptions:u,numVisible:3,numScroll:1,circular:!0,value:this.props.skills,itemTemplate:e=>i.createElement(m,{id:e.id,subject_id:e.subject_id,name:e.name,description:e.description,exercices:e.exercices,image:e.image,premium:e.premium})}))}}var b=h;class E extends i.Component{render(){return i.createElement("div",{className:"p-mr-2 p-p-3 p-mb-2"},i.createElement("h1",null,this.props.name),i.createElement("h2",null,this.props.description),i.createElement("div",{className:""},this.props.subjects.map(e=>i.createElement(b,{key:e.id,id:e.id,name:e.name,description:e.description,skills:e.skills}))))}}var v=E;class g extends i.Component{constructor(e){super(e),this.state={subjects:[]}}componentDidMount(){this.props.database.getSubjects().then(e=>{this.setState({subjects:e})})}render(){return i.createElement("div",{className:"card"},i.createElement("h2",null,"POC"),i.createElement(v,{id:"0",description:"",name:"Premi\xe8re",subjects:this.state.subjects}))}}var k=g,x=s(32),S=s(12),w=(s(69),s(33));class C extends i.Component{constructor(e){super(e),this.state={started:!1,step:1,done:!1,time:0,success:!1}}getContent(){return this.state.done?this.props.exercice.answer:this.getQuestion()}getNbStep(){return this.props.exercice.questions.length-1}getQuestion(){let e=this.props.exercice.questions[0];for(let t=1;t<=this.state.step;t+=1)e+="<li>"+this.props.exercice.questions[t];return e}getResponses(){return["Reponse A","Reponse B","Reponse C","Reponse D"]}finish(){this.props.onFinish({id:Date.now(),success:!0,date:Date.now(),exercice_id:this.props.exercice.id,time:Date.now()-this.state.time}),this.setState({done:!0,success:!0})}start(){this.setState({started:!0,time:Date.now()})}nextStep(){this.state.step===this.getNbStep()?this.finish():this.setState({step:this.state.step+1})}close(){this.setState({done:!1,step:1,started:!1})}getFooter(){return this.state.done?i.createElement("div",null,i.createElement(S.Button,{label:"C'est compris",icon:"pi pi-check",onClick:()=>this.close(),autoFocus:!0})):i.createElement("div",null,this.getResponses().map((e,t)=>i.createElement(S.Button,{key:t,label:e,onClick:()=>this.nextStep(),className:"p-button-text"})))}render(){return i.createElement("div",{className:"card"},i.createElement(S.Button,{label:this.props.exercice.name,icon:"pi pi-external-link",onClick:()=>this.start()}),i.createElement(x.Dialog,{header:this.props.exercice.name,visible:this.state.started,style:{width:"50vw"},footer:this.getFooter(),onHide:()=>this.close()},i.createElement(w.a,null,this.getContent())))}}var f=C,j=s(34),N=s(37);class D extends i.Component{constructor(e){super(e),this.state={skill:{id:"",name:"",description:"",subject_id:"",exercices:[]}}}componentDidMount(){let e=+(window.location.href.split("/").pop()||"8329");this.props.database.getSkill(e).then(e=>{this.setState({skill:e})})}getVideoId(e){return e?e.split("/").pop():""}addResult(e){this.props.database.addResult(e)}render(){var e;return i.createElement("div",{className:"card"},i.createElement("h2",null,null===(e=this.state.skill)||void 0===e?void 0:e.name),i.createElement("div",{className:"p-d-flex"},i.createElement(j.a,{videoId:this.getVideoId(this.state.skill.video)}),i.createElement(N.Divider,{layout:"vertical"}),i.createElement("div",{dangerouslySetInnerHTML:{__html:this.state.skill.description}})),i.createElement("h2",null,"Exercice"),this.state.skill.exercices.map((e,t)=>i.createElement(f,{key:t,exercice:e,onFinish:e=>this.addResult(e)})))}}var _=D,y=s(20);var R=class{getSubject(){return new Promise((e,t)=>{fetch("https://cours-galilee.com/wp-json/wp/v2/comptence?per_page=100&orderby=title&order=asc").then(e=>e.json()).then(t=>{var s=new RegExp("<li>"),i=new Map;t.map(e=>{var t;i.has(e.chapitre[0].ID)||i.set(e.chapitre[0].ID,{id:e.chapitre[0].ID,name:e.chapitre[0].post_title,description:"",skills:[]});let a=[];(e.exercices||[]).map(t=>a.push({id:t.id,skill_id:e.id,name:t.post_title,description:"",enonce:t.enonce,questions:t.enonce.split(s),answer:t.correction,tip:"demerde-toi"}));let r={id:e.id,subject_id:e.chapitre[0].id,name:e.nom,description:e.content.rendered,premium:!1,difficulty:+e.difficulte,video:e.video,image:e.thumbnail.guid,order:+e.ordering,exercices:a};return null===(t=i.get(e.chapitre[0].id))||void 0===t||t.skills.push(r),r}),e(Array.from(i.values()))})})}};class B{constructor(){this.api=void 0,this.db=void 0,this.api=new R,this.db=new y.a(B.DB_NAME),this.db.version(1).stores({subjects:"id",skills:"id",exercices:"id",questions:"id",results:"id"})}isCreated(){return y.a.exists(B.DB_NAME)}addResult(e){return this.db.table("results").add(e)}getSubjects(){return this.db.table("subjects").toArray()}getSkill(e){return this.db.table("skills").get(e)}getExercice(e){return this.db.table("exercices").get(e)}initialize(){return new Promise(e=>{this.api.getSubject().then(t=>{t.forEach(e=>{this.db.table("skills").bulkPut(e.skills),e.skills.forEach(e=>{this.db.table("exercices").bulkPut(e.exercices)})}),this.db.table("subjects").bulkPut(t),e(!0)})})}}B.DB_NAME="galileo";var I=B;class M extends i.Component{constructor(e){super(e),this.database=void 0,this.state={databaseLoaded:!1},this.database=new I}componentDidMount(){this.database.initialize().then(()=>this.setState({databaseLoaded:!0}))}render(){return this.state.databaseLoaded?i.createElement(r.a,null,i.createElement("div",{className:"p-component"},i.createElement("div",{className:"p-mr-2"},i.createElement(n.c,null,i.createElement(n.a,{path:"/skill/:id"},i.createElement(_,{database:this.database})),i.createElement(n.a,{path:"/"},i.createElement(k,{database:this.database})))))):i.createElement("div",{className:"card"},i.createElement(l.ProgressSpinner,null))}}const P=document.getElementById("root");Object(a.render)(i.createElement(M,null),P)}},[[38,1,2]]]);
//# sourceMappingURL=main.d7a7fc16.chunk.js.map